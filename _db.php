<?phpinclude_once('Zend/Db.php');define('DB_HOSTNAME', 'localhost');define('DB_USERNAME', 'root');define('DB_PASSOWRD', '');define('DB_NAME', 'scrapper_suchen');$tables = array(    'categories' => 'data_categories',    'cities'     => 'data_cities',    'objects'    => 'data_objects',    'rel_cc'     => 'rel_category_city');$db = Zend_Db::factory('Pdo_Mysql', array(    'host'     => DB_HOSTNAME,    'username' => DB_USERNAME,    'password' => DB_PASSOWRD,    'dbname'   => DB_NAME,    'charset'  => 'utf8'));$db->getProfiler()->setEnabled(true);/* ---------------Functions------------------ */function getCategoryDataByName($name){    global $db, $tables;    $category = $db->select()                   ->from($tables['categories'])                   ->where('name like ?', $name)                   ->query()                   ->fetch();    if ($category !== false)    {        return $category;    }     $db->insert($tables['categories'], array('name' => $name));    $category = $db->select()                   ->from( $tables['categories'] )                   ->where('category_id = ?', $db->lastInsertId())                   ->query()                   ->fetch();    return $category;}function getCityDataByName($name, $category_id = 0){    global $db, $tables;    $city = $db->select()               ->from($tables['cities'])               ->where('name like ?', $name)               ->query()               ->fetch();    if ($city === false)    {        $db->insert($tables['cities'], array('name' => $name ));        $city = $db->select()                   ->from($tables['cities'])                   ->where('city_id = ?', $db->lastInsertId())                   ->query()                   ->fetch();    }    if ($city === false)    {        return false;    }    if (empty( $category_id))    {        return $city;    }    $city['_rel_cc_'] = array();    $rel = $db->select()              ->from($tables['rel_cc'])              ->where('category_id = ?', $category_id)              ->where('city_id = ?', $city['city_id'])              ->query()              ->fetch();    if ($rel === false)    {            $db->insert($tables['rel_cc'], array('category_id' => $category_id, 'city_id' => $city['city_id']));            $rel = $db->select()                      ->from($tables['rel_cc'])                      ->where('category_id = ?', $category_id)                      ->where('city_id = ?', $city['city_id'])                      ->query()                      ->fetch();    }    if ($rel !== false)    {        $city['_rel_cc_'] = $rel;    }    return $city;}function addVcard($data){    global $db, $tables;    $existing_item = $db->select()                        ->from($tables['objects'])                        ->where('object_id = ?', $data['object_id'])                        ->where('category_id = ?', $data['category_id'])                        ->query()                        ->fetch();    if ($existing_item !== false)    {        $data = array_merge($existing_item, $data);        $db->update(             $tables['objects'],             $data,             'object_id = ' . $db->quote($data['object_id'] ) . ' AND category_id = ' . $data['category_id']);    }    else    {        $db->insert($tables['objects'], $data);    }    $db->getProfiler()->getLastQueryProfile();}?>